{% extends 'AppBundle::base.html.twig' %}


{% block body %}
    <div class="grid">
        <div class="g 3/5@xl">
            <div class="card card--padded">
                <h2 class="g-unit">Upcoming maturities</h2>
                {% include '@partials/securities-list.html.twig' %}
                <p>
                    <a class="link--button" href="{{ path('securities_list') }}">View all securities</a>
                </p>
            </div>
        </div>
        <div class="g 2/5@xl">
                <div class="card card--padded g-unit">
                    <h2 class="g-unit">New</h2>
                    <a class="link--button" href="{{ path('reports_fsa50') }}">FSA50 report</a>
                    <a class="link--button" href="{{ path('securities_list') }}">Filterable Securities</a>
                </div>
                <div class="card card--padded g-unit">
                    <div class="grid">
                    <div class="g 1/2@xl">
                        <p class="text--center">
                            <a class="link--hidden" href="{{ path('securities_list') }}">
                                Securities<br />
                                <span class="a">{{ securitiesCount }}</span>
                            </a>
                        </p>
                    </div>
                    <div class="g 1/2@xl">
                        <p class="text--center">
                            <a class="link--hidden" href="{{ path('groups_list') }}">
                                Issuers<br />
                                <span class="a">{{ issuersCount }}</span>
                            </a>
                        </p>
                    </div>
                    </div>
                </div>
                <div class="card">
                    <div id="chart-grouped" style="height: 300px">
                        <p class="island text--center">Loading chart</p>
                    </div>
                    <script>
                        google.charts.setOnLoadCallback(drawChart);
                        function drawChart() {
                            var data = google.visualization.arrayToDataTable({{ byProduct|json_encode|raw }});

                            var options = {
                                height: 300,
                                pieHole: 0.4,
                                pieStartAngle: 20,
                                backgroundColor: 'transparent',
                                legend : {
                                    position: 'left'
                                },
                                animation: {
                                    duration: 800,
                                    startup: true
                                },
                                chartArea : {
                                    top: 24,
                                    left: 24,
                                    width: '90%',
                                    height: 258
                                },
                                pieSliceText: 'none',
                                colors: ['#3A0676', '#532587', '#6B4498', '#8463A9', '#9D83BB', '#B5A2CC', '#CEC1DD', '#E6E0EE']
                            };

                            var chart = new google.visualization.PieChart(document.getElementById('chart-grouped'));
                            chart.draw(data, options);
                        }
                    </script>
            </div>
        </div>
    </div>
{% endblock %}
